<script>
    let model;

    async function loadModel() {
        model = await mobilenet.load();
        console.log("Model Loaded!");
    }
    loadModel();

    document.getElementById("imageUpload").addEventListener("change", () => {
        const file = document.getElementById("imageUpload").files[0];
        const imgPreview = document.getElementById("previewImage");

        imgPreview.src = URL.createObjectURL(file);
        imgPreview.style.display = "block";
    });

    const foodInfo = {
        "banana": {
            healthy: "Healthy",
            calories: "105 kcal",
            nutrients: "Potassium, Vitamin B6, Vitamin C, Fiber",
            benefits: "Boosts energy, good for digestion",
            bestTime: "Afternoon"
        },
        "apple": {
            healthy: "Healthy",
            calories: "95 kcal",
            nutrients: "Fiber, Vitamin C, Antioxidants",
            benefits: "Good for heart, controls weight",
            bestTime: "Morning"
        },
        "pizza": {
            healthy: "Junk Food",
            calories: "266 kcal per slice",
            nutrients: "High carbs, high fat, processed cheese",
            benefits: "Tasty but unhealthy",
            bestTime: "Avoid daily"
        },
        "orange": {
            healthy: "Healthy",
            calories: "62 kcal",
            nutrients: "Vitamin C, Fiber, Potassium",
            benefits: "Boosts immunity, good for skin",
            bestTime: "Morning"
        }
    };

    async function classifyImage() {
        const result = document.getElementById("result");
        const info = document.getElementById("extraInfo");

        result.textContent = "Classifying...";
        info.textContent = "";

        const img = document.getElementById("previewImage");
        const prediction = await model.classify(img);

        const detected = prediction[0].className.toLowerCase();
        result.textContent = "Detected: " + prediction[0].className;

        let key = Object.keys(foodInfo).find(food => detected.includes(food));

        if (key) {
            const f = foodInfo[key];
            info.innerHTML =
                `<br>ğŸ½ï¸ <b>Type: </b> ${f.healthy}
                <br>ğŸ”¥ <b>Calories: </b> ${f.calories}
                <br>ğŸŠ <b>Nutrients: </b> ${f.nutrients}
                <br>ğŸ’ª <b>Benefits: </b> ${f.benefits}
                <br>â° <b>Best Time: </b> ${f.bestTime}`;
        } else {
            info.textContent = "Food details not in database.";
        }
    }
</script>
