<script>
    let model;

    async function loadModel() {
        try {
            model = await mobilenet.load();
            console.log("Model loaded");
        } catch (error) {
            console.error("Model loading failed:", error);
        }
    }

    loadModel();

    document.getElementById("imageUpload").addEventListener("change", () => {
        const file = document.getElementById("imageUpload").files[0];
        const preview = document.getElementById("previewImage");

        preview.src = URL.createObjectURL(file);
        preview.style.display = "block";
    });

    async function classifyImage() {
        const resultText = document.getElementById("result");
        const extra = document.getElementById("extraInfo");

        resultText.textContent = "Classifying...";
        extra.textContent = "";

        try {
            const img = document.getElementById("previewImage");

            const prediction = await model.classify(img);
            const item = prediction[0].className.toLowerCase();

            resultText.textContent = "Detected: " + prediction[0].className;

            let info = "";

            if (item.includes("banana")) {
                info = "üçå Healthy Food | Best time: Afternoon";
            } else if (item.includes("apple")) {
                info = "üçé Healthy Food | Best time: Morning";
            } else if (item.includes("pizza")) {
                info = "üçï Junk Food | Best time: Avoid daily";
            } else if (item.includes("orange")) {
                info = "üçä Healthy Food | Best time: Morning";
            } else {
                info = "Food details not in database.";
            }

            extra.textContent = info;

        } catch (error) {
            resultText.textContent = "Error Classifying!";
            console.error(error);
        }
    }
</script>
